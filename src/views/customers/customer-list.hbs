<div class="my-2 text-center" style="height:50px;">
    <a href="/admin/customers/add" class="m-8 btn btn-primary">
        Añadir un cliente
    </a>
</div>

<div class="container col-md-10" style="height:70vh;overflow-y:scroll;">
    <table class="table table-striped table-light">
        <thead style="position: sticky; top: 0;">
            <tr>
                <th class="align-middle">Estado</th>
                <th class="align-middle">Nombre completo</th>
                <th class="align-middle">Documento</th>
                <th class="align-middle">Teléfono</th>
                <th class="align-middle">Correo</th>
                <th class="align-middle">Proceso de {{#if is_credit}}crédito{{else}}trámite{{/if}}</th>
                <th class="align-middle">Número de {{#if is_credit}}cuenta{{else}}placa{{/if}}</th>
                {{#if is_credit}}<th class="align-middle">Monto de crédito</th>{{/if}}
                <th class="align-middle">Saldo disponible</th>
                <th class="align-middle">Archivos Subidos</th>
                <th class="align-middle">Fecha de Creación</th>
                <th class="align-middle">Foto</th>
                <th class="align-middle">Acciones</th>
            </tr>
        </thead>
        <tbody>
            {{#each customers}}
            <tr>
                <td class="align-middle text-center text-uppercase" >{{status}}</td>
                <td class="align-middle text-center">{{fullname}}</td>
                <td class="align-middle text-center">{{document}}</td>
                <td class="align-middle text-center">
                    {{#if phone}}
                    {{phone}}
                    {{else}}
                    ---
                    {{/if}}
                </td>
                <td class="align-middle text-center">
                    {{#if email}}
                    {{email}}
                    {{else}}
                    ---
                    {{/if}}
                </td>
                <td class="align-middle text-center">
                    {{#if credit_process}}
                    {{credit_process}}
                    {{else}}
                    ---
                    {{/if}}
                </td>
                <td class="align-middle text-center">
                    {{#if bank_number}}
                    {{bank_number}}
                    {{else}}
                    ---
                    {{/if}}
                </td>

                {{#if is_credit}}<td class="align-middle text-center">{{formatCurrency credit_amount}}</td>{{/if}}
                <td class="align-middle text-center">{{formatCurrency available_balance}}</td>
                <td class="align-middle text-center" class="text-center">
                    {{#if files}}
                    <ul>
                        {{#each files}}
                        <li><a href="https://drive.google.com/file/d/{{id}}/view" target="_blank">{{name}}</a></li>
                        {{/each}}
                    </ul>
                    {{else}}
                    Sin archivos
                    {{/if}}
                </td>
                <td class="align-middle text-center" id="date">{{created_at}}</td>

                <td class="align-middle text-center text-uppercase">
                    <img class="mx-auto img-circle" src="{{photoUrl}}" alt="photo" style="height: 4vh; width:4vh">
                    </div>
                    <a class="mx-1" style="color:#39439a" href="/admin/customers/updatePhoto/{{id}}" >Cambiar</a>
                </td>

                <td class="align-middle d-flex flex-column">
                    <a class="mx-1" style="color:#39439a" href="/admin/customers/edit/{{id}}">Editar</a>
                    <a class="mx-1" style="color:#046947" href="/admin/customers/payments/{{id}}">Ver Pagos</a>
                    <a class="mx-1" style="color:red" href="/admin/customers/delete/{{id}}" onclick="return confirm('¿Estás seguro de que quieres eliminar este elemento?')">Eliminar</a>
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>
</div>


<script>
    // Selecciona el elemento que contiene la fecha
    let dateElements = document.querySelectorAll("#date");
    // Obtiene el contenido del elemento (la fecha sin formato)

    for (let dateElement of dateElements) {
        const date = new Date(dateElement.textContent)
        dateElement.textContent = date.toLocaleDateString("es-CO")
    }

</script>